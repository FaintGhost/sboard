services:
  sboard-node:
    container_name: sboard-node
    # Default: pull a prebuilt image (recommended for low-spec VPS).
    # Override by setting `SBOARD_NODE_IMAGE`.
    image: "${SBOARD_NODE_IMAGE:-faintghost/sboard-node:latest}"
    restart: unless-stopped

    # This is simplest for a proxy node: inbounds can bind host ports directly (443, etc).
    # IMPORTANT: `NODE_HTTP_ADDR=:3000` will be publicly reachable unless you firewall it.
    # Recommend: allow only the Panel server IP to access port 3000.
    network_mode: host

    # Persist last successful sync payload, so after container restart the node restores inbounds automatically.
    volumes:
      - ./data:/data

    environment:
      NODE_HTTP_ADDR: ":3000"
      NODE_SECRET_KEY: "${NODE_SECRET_KEY:-change-me}"
      NODE_LOG_LEVEL: "${NODE_LOG_LEVEL:-debug}"
      NODE_STATE_PATH: "${NODE_STATE_PATH:-/data/last_sync.json}"
